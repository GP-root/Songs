"use strict";(self["webpackChunksongs"]=self["webpackChunksongs"]||[]).push([[276],{4193:function(e,t,i){i.r(t),i.d(t,{default:function(){return le}});var n=i(8970),s=(i(3450),i(8868),i(6770)),a=i(7755),o=(i(6886),i(4704)),r=(i(4745),i(9894)),l=(i(1262),i(440)),u=i(8643),c=i(4367),d=i(4804),h=i(4059);i(7658);function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,i){return t&&f(e.prototype,t),i&&f(e,i),e}function p(e){return+e.replace(/px/,"")}function g(e){var t=window.devicePixelRatio,i=getComputedStyle(e),n=p(i.getPropertyValue("width")),s=p(i.getPropertyValue("height"));e.setAttribute("width",(n*t).toString()),e.setAttribute("height",(s*t).toString())}function y(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.random()*(t-e)+e;return Math.floor(n*Math.pow(10,i))/Math.pow(10,i)}function b(e){return e[y(0,e.length)]}var w=.00125,C=5e-4,S=9e-4,x=1e-5,j=6,P=80,_=.9,k=1.7,z=.2,A=.6,R=.03,W=.07,M=15,I=82,q=150,F=100,D=250,N=40,U=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function B(e){var t=1920;return Math.log(e)/Math.log(t)}var V=function(){function e(t){v(this,e);var i=t.initialPosition,n=t.direction,s=t.confettiRadius,a=t.confettiColors,o=t.emojis,r=t.emojiSize,l=t.canvasWidth,u=y(_,k,3),c=u*B(l);this.confettiSpeed={x:c,y:c},this.finalConfettiSpeedX=y(z,A,3),this.rotationSpeed=o.length?.01:y(R,W,3)*B(l),this.dragForceCoefficient=y(C,S,6),this.radius={x:s,y:s},this.initialRadius=s,this.rotationAngle="left"===n?y(0,.2,3):y(-.2,0,3),this.emojiSize=r,this.emojiRotationAngle=y(0,2*Math.PI),this.radiusYUpdateDirection="down";var d="left"===n?y(I,M)*Math.PI/180:y(-M,-I)*Math.PI/180;this.absCos=Math.abs(Math.cos(d)),this.absSin=Math.abs(Math.sin(d));var h=y(-q,0),f={x:i.x+("left"===n?-h:h)*this.absCos,y:i.y-h*this.absSin};this.currentPosition=Object.assign({},f),this.initialPosition=Object.assign({},f),this.color=o.length?null:b(a),this.emoji=o.length?b(o):null,this.createdAt=(new Date).getTime(),this.direction=n}return m(e,[{key:"draw",value:function(e){var t=this.currentPosition,i=this.radius,n=this.color,s=this.emoji,a=this.rotationAngle,o=this.emojiRotationAngle,r=this.emojiSize,l=window.devicePixelRatio;n?(e.fillStyle=n,e.beginPath(),e.ellipse(t.x*l,t.y*l,i.x*l,i.y*l,a,0,2*Math.PI),e.fill()):s&&(e.font="".concat(r,"px serif"),e.save(),e.translate(l*t.x,l*t.y),e.rotate(o),e.textAlign="center",e.fillText(s,0,0),e.restore())}},{key:"updatePosition",value:function(e,t){var i=this.confettiSpeed,n=this.dragForceCoefficient,s=this.finalConfettiSpeedX,a=this.radiusYUpdateDirection,o=this.rotationSpeed,r=this.createdAt,l=this.direction,u=t-r;i.x>s&&(this.confettiSpeed.x-=n*e),this.currentPosition.x+=i.x*("left"===l?-this.absCos:this.absCos)*e,this.currentPosition.y=this.initialPosition.y-i.y*this.absSin*u+w*Math.pow(u,2)/2,this.rotationSpeed-=this.emoji?1e-4:x*e,this.rotationSpeed<0&&(this.rotationSpeed=0),this.emoji?this.emojiRotationAngle+=this.rotationSpeed*e%(2*Math.PI):"down"===a?(this.radius.y-=e*o,this.radius.y<=0&&(this.radius.y=0,this.radiusYUpdateDirection="up")):(this.radius.y+=e*o,this.radius.y>=this.initialRadius&&(this.radius.y=this.initialRadius,this.radiusYUpdateDirection="down"))}},{key:"getIsVisibleOnCanvas",value:function(e){return this.currentPosition.y<e+F}}]),e}();function T(){var e=document.createElement("canvas");return e.style.position="fixed",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.left="0",e.style.zIndex="1000",e.style.pointerEvents="none",document.body.appendChild(e),e}function Z(e){var t=e.confettiRadius,i=void 0===t?j:t,n=e.confettiNumber,s=void 0===n?e.confettiesNumber||(e.emojis?N:D):n,a=e.confettiColors,o=void 0===a?U:a,r=e.emojis,l=void 0===r?e.emojies||[]:r,u=e.emojiSize,c=void 0===u?P:u;return e.emojies&&console.error("emojies argument is deprecated, please use emojis instead"),e.confettiesNumber&&console.error("confettiesNumber argument is deprecated, please use confettiNumber instead"),{confettiRadius:i,confettiNumber:s,confettiColors:o,emojis:l,emojiSize:c}}var H=function(){function e(t){var i=this;v(this,e),this.canvasContext=t,this.shapes=[],this.promise=new Promise((function(e){return i.resolvePromise=e}))}return m(e,[{key:"getBatchCompletePromise",value:function(){return this.promise}},{key:"addShapes",value:function(){var e;(e=this.shapes).push.apply(e,arguments)}},{key:"complete",value:function(){var e;return!this.shapes.length&&(null===(e=this.resolvePromise)||void 0===e||e.call(this),!0)}},{key:"processShapes",value:function(e,t,i){var n=this,s=e.timeDelta,a=e.currentTime;this.shapes=this.shapes.filter((function(e){return e.updatePosition(s,a),e.draw(n.canvasContext),!i||e.getIsVisibleOnCanvas(t)}))}}]),e}(),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,e),this.activeConfettiBatches=[],this.canvas=t.canvas||T(),this.canvasContext=this.canvas.getContext("2d"),this.requestAnimationFrameRequested=!1,this.lastUpdated=(new Date).getTime(),this.iterationIndex=0,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}return m(e,[{key:"loop",value:function(){this.requestAnimationFrameRequested=!1,g(this.canvas);var e=(new Date).getTime(),t=e-this.lastUpdated,i=this.canvas.offsetHeight,n=this.iterationIndex%10===0;this.activeConfettiBatches=this.activeConfettiBatches.filter((function(s){return s.processShapes({timeDelta:t,currentTime:e},i,n),!n||!s.complete()})),this.iterationIndex++,this.queueAnimationFrameIfNeeded(e)}},{key:"queueAnimationFrameIfNeeded",value:function(e){this.requestAnimationFrameRequested||this.activeConfettiBatches.length<1||(this.requestAnimationFrameRequested=!0,this.lastUpdated=e||(new Date).getTime(),requestAnimationFrame(this.loop))}},{key:"addConfetti",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Z(e),i=t.confettiRadius,n=t.confettiNumber,s=t.confettiColors,a=t.emojis,o=t.emojiSize,r=this.canvas.getBoundingClientRect(),l=r.width,u=r.height,c=5*u/7,d={x:0,y:c},h={x:l,y:c},v=new H(this.canvasContext),f=0;f<n/2;f++){var m=new V({initialPosition:d,direction:"right",confettiRadius:i,confettiColors:s,confettiNumber:n,emojis:a,emojiSize:o,canvasWidth:l}),p=new V({initialPosition:h,direction:"left",confettiRadius:i,confettiColors:s,confettiNumber:n,emojis:a,emojiSize:o,canvasWidth:l});v.addShapes(m,p)}return this.activeConfettiBatches.push(v),this.queueAnimationFrameIfNeeded(),v.getBatchCompletePromise()}},{key:"clearCanvas",value:function(){this.activeConfettiBatches=[]}}]),e}(),Y=O,E=i(9226),X=i(5170),G=i(7578),J=i(9252),K=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(t){a(t)}}function r(e){try{l(n["throw"](e))}catch(t){a(t)}}function l(e){e.done?i(e.value):s(e.value).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const L={class:"back"},Q={class:"dataBack"},$={class:"data"},ee={class:"title"},te={class:"alia"},ie={class:"user"},ne={class:"operate"},se={class:"list"};var ae=(0,l.aZ)({__name:"detailed",setup(e){const t=(0,d.tv)(),i=new Y,v=t.currentRoute.value.params.id,f=(0,c.iH)(),m=(0,c.iH)([]);(0,l.bv)((()=>K(this,void 0,void 0,(function*(){f.value=yield h.c5.getDetail(v),m.value=f.value.songs}))));const p=(0,c.iH)(!1),g=()=>{p.value=!p.value},y=(0,c.iH)(!1),b=()=>{y.value=!y.value},w=()=>K(this,void 0,void 0,(function*(){var e,t;if(f.value){const n=yield h.c5.subscribe(v,!(null===(e=f.value)||void 0===e?void 0:e.isSubscribed));n&&!(null===(t=f.value)||void 0===t?void 0:t.isSubscribed)&&i.addConfetti(),f.value.isSubscribed=!f.value.isSubscribed}}));return(e,t)=>{var i,d,h,C,S;const x=r.F8,j=(0,l.up)("Share"),P=o.gn,_=a.mi,k=s.Z,z=(0,l.up)("Check"),A=(0,l.up)("FolderAdd"),R=n.zd;return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",L,[(0,l._)("div",Q,[(0,l.Wm)(x,{class:"cover",src:null===(d=null===(i=f.value)||void 0===i?void 0:i.cover)||void 0===d?void 0:d.url,fit:"cover",loading:"lazy"},null,8,["src"]),(0,l._)("div",$,[(0,l._)("div",ee,[(0,l._)("span",te,(0,u.zw)(null===(h=f.value)||void 0===h?void 0:h.name),1)]),(0,l._)("div",ie,[(0,l.Uk)(" 歌手： "),(0,l.Wm)(E.Z,{singers:null===(C=f.value)||void 0===C?void 0:C.singers.singers},null,8,["singers"])]),(0,l._)("div",{class:"description",onClick:g},[(0,l._)("span",null,(0,u.zw)(null===(S=f.value)||void 0===S?void 0:S.description),1)]),(0,l._)("div",ne,[(0,l.Wm)(_,{text:"",type:"primary",title:"分享"},{default:(0,l.w5)((()=>{var e;return[(0,l.Wm)(P,{size:"20"},{default:(0,l.w5)((()=>[(0,l.Wm)(j)])),_:1}),(0,l._)("span",null,(0,u.zw)(null===(e=f.value)||void 0===e?void 0:e.count.share),1)]})),_:1}),(0,l.Wm)(_,{text:"",type:"primary",title:"显示评论",onClick:b},{default:(0,l.w5)((()=>{var e;return[(0,l.Wm)(P,{size:"20"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{name:"comment"})])),_:1}),(0,l._)("span",null,(0,u.zw)(null===(e=f.value)||void 0===e?void 0:e.count.comment),1)]})),_:1}),(0,l.Wm)(_,{text:"",type:"primary",title:"收藏",onClick:w},{default:(0,l.w5)((()=>{var e,t;return[(null===(e=f.value)||void 0===e?void 0:e.isSubscribed)?((0,l.wg)(),(0,l.j4)(P,{key:0,size:"20"},{default:(0,l.w5)((()=>[(0,l.Wm)(z)])),_:1})):((0,l.wg)(),(0,l.j4)(P,{key:1,size:"20"},{default:(0,l.w5)((()=>[(0,l.Wm)(A)])),_:1})),(0,l._)("span",null,(0,u.zw)(null===(t=f.value)||void 0===t?void 0:t.count.subscribed),1)]})),_:1})])])]),(0,l._)("div",se,[(0,l.Wm)(X.Z,{songs:m.value},null,8,["songs"])])]),(0,l.Wm)(R,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),"with-header":!1},{default:(0,l.w5)((()=>{var e;return[(0,l.Wm)(G.Z,{"cover-img":null===(e=f.value.cover)||void 0===e?void 0:e.url,description:f.value.description,"album-type":f.value.type},null,8,["cover-img","description","album-type"])]})),_:1},8,["modelValue"]),(0,l.Wm)(R,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=e=>y.value=e),"with-header":!1,"z-index":0},{default:(0,l.w5)((()=>[(0,l.Wm)(J.Z,{id:(0,c.SU)(v),type:"专辑"},null,8,["id"])])),_:1},8,["modelValue"])],64)}}}),oe=i(465);const re=(0,oe.Z)(ae,[["__scopeId","data-v-31b5de00"]]);var le=re}}]);