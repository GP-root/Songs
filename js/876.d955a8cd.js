"use strict";(self["webpackChunksongs"]=self["webpackChunksongs"]||[]).push([[876],{2743:function(e,t,i){i.r(t),i.d(t,{default:function(){return ue}});var n=i(8970),a=(i(3450),i(8868),i(6770)),s=i(7755),o=(i(6886),i(4704)),r=(i(4745),i(9894)),u=(i(1262),i(440)),l=i(8643),c=i(4367),d=i(4804),h=i(1809);i(7658);function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&m(e.prototype,t),i&&m(e,i),e}function p(e){return+e.replace(/px/,"")}function b(e){var t=window.devicePixelRatio,i=getComputedStyle(e),n=p(i.getPropertyValue("width")),a=p(i.getPropertyValue("height"));e.setAttribute("width",(n*t).toString()),e.setAttribute("height",(a*t).toString())}function y(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.random()*(t-e)+e;return Math.floor(n*Math.pow(10,i))/Math.pow(10,i)}function g(e){return e[y(0,e.length)]}var w=.00125,C=5e-4,x=9e-4,S=1e-5,j=6,P=80,_=.9,k=1.7,z=.2,A=.6,R=.03,W=.07,I=15,M=82,q=150,F=100,D=250,N=40,U=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function B(e){var t=1920;return Math.log(e)/Math.log(t)}var V=function(){function e(t){v(this,e);var i=t.initialPosition,n=t.direction,a=t.confettiRadius,s=t.confettiColors,o=t.emojis,r=t.emojiSize,u=t.canvasWidth,l=y(_,k,3),c=l*B(u);this.confettiSpeed={x:c,y:c},this.finalConfettiSpeedX=y(z,A,3),this.rotationSpeed=o.length?.01:y(R,W,3)*B(u),this.dragForceCoefficient=y(C,x,6),this.radius={x:a,y:a},this.initialRadius=a,this.rotationAngle="left"===n?y(0,.2,3):y(-.2,0,3),this.emojiSize=r,this.emojiRotationAngle=y(0,2*Math.PI),this.radiusYUpdateDirection="down";var d="left"===n?y(M,I)*Math.PI/180:y(-I,-M)*Math.PI/180;this.absCos=Math.abs(Math.cos(d)),this.absSin=Math.abs(Math.sin(d));var h=y(-q,0),m={x:i.x+("left"===n?-h:h)*this.absCos,y:i.y-h*this.absSin};this.currentPosition=Object.assign({},m),this.initialPosition=Object.assign({},m),this.color=o.length?null:g(s),this.emoji=o.length?g(o):null,this.createdAt=(new Date).getTime(),this.direction=n}return f(e,[{key:"draw",value:function(e){var t=this.currentPosition,i=this.radius,n=this.color,a=this.emoji,s=this.rotationAngle,o=this.emojiRotationAngle,r=this.emojiSize,u=window.devicePixelRatio;n?(e.fillStyle=n,e.beginPath(),e.ellipse(t.x*u,t.y*u,i.x*u,i.y*u,s,0,2*Math.PI),e.fill()):a&&(e.font="".concat(r,"px serif"),e.save(),e.translate(u*t.x,u*t.y),e.rotate(o),e.textAlign="center",e.fillText(a,0,0),e.restore())}},{key:"updatePosition",value:function(e,t){var i=this.confettiSpeed,n=this.dragForceCoefficient,a=this.finalConfettiSpeedX,s=this.radiusYUpdateDirection,o=this.rotationSpeed,r=this.createdAt,u=this.direction,l=t-r;i.x>a&&(this.confettiSpeed.x-=n*e),this.currentPosition.x+=i.x*("left"===u?-this.absCos:this.absCos)*e,this.currentPosition.y=this.initialPosition.y-i.y*this.absSin*l+w*Math.pow(l,2)/2,this.rotationSpeed-=this.emoji?1e-4:S*e,this.rotationSpeed<0&&(this.rotationSpeed=0),this.emoji?this.emojiRotationAngle+=this.rotationSpeed*e%(2*Math.PI):"down"===s?(this.radius.y-=e*o,this.radius.y<=0&&(this.radius.y=0,this.radiusYUpdateDirection="up")):(this.radius.y+=e*o,this.radius.y>=this.initialRadius&&(this.radius.y=this.initialRadius,this.radiusYUpdateDirection="down"))}},{key:"getIsVisibleOnCanvas",value:function(e){return this.currentPosition.y<e+F}}]),e}();function T(){var e=document.createElement("canvas");return e.style.position="fixed",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.left="0",e.style.zIndex="1000",e.style.pointerEvents="none",document.body.appendChild(e),e}function H(e){var t=e.confettiRadius,i=void 0===t?j:t,n=e.confettiNumber,a=void 0===n?e.confettiesNumber||(e.emojis?N:D):n,s=e.confettiColors,o=void 0===s?U:s,r=e.emojis,u=void 0===r?e.emojies||[]:r,l=e.emojiSize,c=void 0===l?P:l;return e.emojies&&console.error("emojies argument is deprecated, please use emojis instead"),e.confettiesNumber&&console.error("confettiesNumber argument is deprecated, please use confettiNumber instead"),{confettiRadius:i,confettiNumber:a,confettiColors:o,emojis:u,emojiSize:c}}var Z=function(){function e(t){var i=this;v(this,e),this.canvasContext=t,this.shapes=[],this.promise=new Promise((function(e){return i.resolvePromise=e}))}return f(e,[{key:"getBatchCompletePromise",value:function(){return this.promise}},{key:"addShapes",value:function(){var e;(e=this.shapes).push.apply(e,arguments)}},{key:"complete",value:function(){var e;return!this.shapes.length&&(null===(e=this.resolvePromise)||void 0===e||e.call(this),!0)}},{key:"processShapes",value:function(e,t,i){var n=this,a=e.timeDelta,s=e.currentTime;this.shapes=this.shapes.filter((function(e){return e.updatePosition(a,s),e.draw(n.canvasContext),!i||e.getIsVisibleOnCanvas(t)}))}}]),e}(),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,e),this.activeConfettiBatches=[],this.canvas=t.canvas||T(),this.canvasContext=this.canvas.getContext("2d"),this.requestAnimationFrameRequested=!1,this.lastUpdated=(new Date).getTime(),this.iterationIndex=0,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}return f(e,[{key:"loop",value:function(){this.requestAnimationFrameRequested=!1,b(this.canvas);var e=(new Date).getTime(),t=e-this.lastUpdated,i=this.canvas.offsetHeight,n=this.iterationIndex%10===0;this.activeConfettiBatches=this.activeConfettiBatches.filter((function(a){return a.processShapes({timeDelta:t,currentTime:e},i,n),!n||!a.complete()})),this.iterationIndex++,this.queueAnimationFrameIfNeeded(e)}},{key:"queueAnimationFrameIfNeeded",value:function(e){this.requestAnimationFrameRequested||this.activeConfettiBatches.length<1||(this.requestAnimationFrameRequested=!0,this.lastUpdated=e||(new Date).getTime(),requestAnimationFrame(this.loop))}},{key:"addConfetti",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=H(e),i=t.confettiRadius,n=t.confettiNumber,a=t.confettiColors,s=t.emojis,o=t.emojiSize,r=this.canvas.getBoundingClientRect(),u=r.width,l=r.height,c=5*l/7,d={x:0,y:c},h={x:u,y:c},v=new Z(this.canvasContext),m=0;m<n/2;m++){var f=new V({initialPosition:d,direction:"right",confettiRadius:i,confettiColors:a,confettiNumber:n,emojis:s,emojiSize:o,canvasWidth:u}),p=new V({initialPosition:h,direction:"left",confettiRadius:i,confettiColors:a,confettiNumber:n,emojis:s,emojiSize:o,canvasWidth:u});v.addShapes(f,p)}return this.activeConfettiBatches.push(v),this.queueAnimationFrameIfNeeded(),v.getBatchCompletePromise()}},{key:"clearCanvas",value:function(){this.activeConfettiBatches=[]}}]),e}(),Y=O,E=i(9403),X=i(2748),G=i(5838),J=i(9252),K=function(e,t,i,n){function a(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(t){s(t)}}function r(e){try{u(n["throw"](e))}catch(t){s(t)}}function u(e){e.done?i(e.value):a(e.value).then(o,r)}u((n=n.apply(e,t||[])).next())}))};const L={class:"back"},Q={class:"dataBack"},$={class:"data"},ee={class:"title"},te={class:"alia"},ie={class:"user"},ne={class:"operate"},ae={class:"list"};var se=(0,u.aZ)({__name:"detailed",setup(e){const t=(0,d.tv)(),i=new Y,v=t.currentRoute.value.params.id,m=(0,c.iH)(),f=(0,c.iH)([]),p=(0,c.iH)(0);(0,u.bv)((()=>K(this,void 0,void 0,(function*(){m.value=yield(0,h.RD)(v),f.value=m.value.songs,p.value=m.value.album.songCount}))));const b=(0,c.iH)(!1),y=()=>{b.value=!b.value},g=(0,c.iH)(!1),w=()=>{g.value=!g.value},C=()=>K(this,void 0,void 0,(function*(){(yield(0,h.fA)(v,!m.value.album.subscribed))&&!m.value.album.subscribed&&i.addConfetti(),m.value.album.subscribed=!m.value.album.subscribed}));return(e,t)=>{var i,d,h,x;const S=r.F8,j=(0,u.up)("Share"),P=o.gn,_=s.mi,k=a.Z,z=(0,u.up)("Check"),A=(0,u.up)("FolderAdd"),R=n.zd;return(0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u._)("div",L,[(0,u._)("div",Q,[(0,u.Wm)(S,{class:"cover",src:null===(i=m.value)||void 0===i?void 0:i.album.cover,fit:"cover",loading:"lazy"},null,8,["src"]),(0,u._)("div",$,[(0,u._)("div",ee,[(0,u._)("span",te,(0,l.zw)(null===(d=m.value)||void 0===d?void 0:d.album.name),1)]),(0,u._)("div",ie,[(0,u.Uk)(" 歌手： "),(0,u.Wm)(E.Z,{artists:null===(h=m.value)||void 0===h?void 0:h.artists.artists},null,8,["artists"])]),(0,u._)("div",{class:"description",onClick:y},[(0,u._)("span",null,(0,l.zw)(null===(x=m.value)||void 0===x?void 0:x.album.description),1)]),(0,u._)("div",ne,[(0,u.Wm)(_,{text:"",type:"primary",title:"分享"},{default:(0,u.w5)((()=>{var e;return[(0,u.Wm)(P,{size:"20"},{default:(0,u.w5)((()=>[(0,u.Wm)(j)])),_:1}),(0,u._)("span",null,(0,l.zw)(null===(e=m.value)||void 0===e?void 0:e.album.shareCount),1)]})),_:1}),(0,u.Wm)(_,{text:"",type:"primary",title:"显示评论",onClick:w},{default:(0,u.w5)((()=>{var e;return[(0,u.Wm)(P,{size:"20"},{default:(0,u.w5)((()=>[(0,u.Wm)(k,{name:"comment"})])),_:1}),(0,u._)("span",null,(0,l.zw)(null===(e=m.value)||void 0===e?void 0:e.album.commentCount),1)]})),_:1}),(0,u.Wm)(_,{text:"",type:"primary",title:"收藏",onClick:C},{default:(0,u.w5)((()=>{var e,t;return[(null===(e=m.value)||void 0===e?void 0:e.album.subscribed)?((0,u.wg)(),(0,u.j4)(P,{key:0,size:"20"},{default:(0,u.w5)((()=>[(0,u.Wm)(z)])),_:1})):((0,u.wg)(),(0,u.j4)(P,{key:1,size:"20"},{default:(0,u.w5)((()=>[(0,u.Wm)(A)])),_:1})),(0,u._)("span",null,(0,l.zw)(null===(t=m.value)||void 0===t?void 0:t.album.subscribedCount),1)]})),_:1})])])]),(0,u._)("div",ae,[(0,u.Wm)(X.Z,{songs:f.value,"songs-count":p.value},null,8,["songs","songs-count"])])]),(0,u.Wm)(R,{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),"with-header":!1},{default:(0,u.w5)((()=>[(0,u.Wm)(G.Z,{coverImg:m.value.album.cover,description:m.value.album.description,"album-type":m.value.album.type},null,8,["coverImg","description","album-type"])])),_:1},8,["modelValue"]),(0,u.Wm)(R,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),"with-header":!1,"z-index":0},{default:(0,u.w5)((()=>[(0,u.Wm)(J.Z,{id:(0,c.SU)(v),type:"专辑"},null,8,["id"])])),_:1},8,["modelValue"])],64)}}}),oe=i(465);const re=(0,oe.Z)(se,[["__scopeId","data-v-7e4d1b12"]]);var ue=re}}]);