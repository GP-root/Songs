"use strict";(self["webpackChunksongs"]=self["webpackChunksongs"]||[]).push([[692],{3692:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var a=n(9894),u=(n(3450),n(1262),n(7658),n(440)),i=n(4367),c=n(4804),r=n(7837),o=n(4059),s=n(708),l=n(1214),d=function(e,t,n,a){function u(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function c(e){try{o(a.next(e))}catch(t){i(t)}}function r(e){try{o(a["throw"](e))}catch(t){i(t)}}function o(e){e.done?n(e.value):u(e.value).then(c,r)}o((a=a.apply(e,t||[])).next())}))};const v=e=>((0,u.dD)("data-v-2ee83629"),e=e(),(0,u.Cn)(),e),f={class:"back"},p=v((()=>(0,u._)("p",null,"使用网易云APP扫码登录",-1))),h={class:"image"};var y=(0,u.aZ)({__name:"login-qr",setup(e){const t=(0,r.L)(),n=(0,c.tv)();(0,u.bv)((()=>{k()})),(0,u.Ah)((()=>{clearInterval(g)}));const v=(0,i.iH)(""),y=(0,i.iH)(""),m=(0,i.iH)(800),k=()=>d(this,void 0,void 0,(function*(){try{return y.value=yield o.ym.getKey(),v.value=yield o.ym.getBase64(y.value),m.value=801,!0}catch(e){return(0,s.A)(`二维码创建失败${e}`,{type:"error",timeout:2e3}),!1}})),g=setInterval((()=>d(this,void 0,void 0,(function*(){if(!v.value)return;const{statusCode:e,cookie:a}=yield o.ym.checkQRStatus(y.value);switch(m.value=e,m.value){case 800:(0,s.A)("二维码失效,请刷新页面",{type:"error",timeout:2e3});break;case 803:(0,s.A)("登录成功",{type:"success",timeout:1500}),t.update_cookie(a);const{id:e,name:u}=yield o.xR.getIdAndName();t.update_login(!0),t.update_id(e),t.update_name(u),l.Z.setItems({cookie:a,id:e.toString(),name:u}),n.push(n.currentRoute.value.query.redirect||"/");break;default:break}}))),2e3);return(e,t)=>{const n=a.F8;return(0,u.wg)(),(0,u.iD)("div",f,[p,(0,u._)("div",h,[(0,u.Wm)(n,{style:{width:"200px",height:"200px"},src:v.value,fit:"contain"},null,8,["src"])])])}}}),m=n(465);const k=(0,m.Z)(y,[["__scopeId","data-v-2ee83629"]]);var g=k}}]);