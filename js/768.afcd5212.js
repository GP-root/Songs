"use strict";(self["webpackChunksongs"]=self["webpackChunksongs"]||[]).push([[768],{7768:function(e,t,n){n.r(t),n.d(t,{default:function(){return _}});var a=n(9894),u=(n(3450),n(1262),n(7658),n(440)),i=n(4367),r=n(4804),c=n(7837),o=n(1809),s=n(708),l=n(1214),d=function(e,t,n,a){function u(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function r(e){try{o(a.next(e))}catch(t){i(t)}}function c(e){try{o(a["throw"](e))}catch(t){i(t)}}function o(e){e.done?n(e.value):u(e.value).then(r,c)}o((a=a.apply(e,t||[])).next())}))};const v=e=>((0,u.dD)("data-v-afe27772"),e=e(),(0,u.Cn)(),e),f={class:"back"},p=v((()=>(0,u._)("p",null,"使用网易云APP扫码登录",-1))),h={class:"image"};var y=(0,u.aZ)({__name:"login-qr",setup(e){const t=(0,c.L)(),n=(0,r.tv)();(0,u.bv)((()=>{m()})),(0,u.Ah)((()=>{clearInterval(_)}));const v=(0,i.iH)(""),y=(0,i.iH)(""),k=(0,i.iH)(800),m=()=>d(this,void 0,void 0,(function*(){try{return y.value=yield(0,o.V6)(),v.value=yield(0,o.Os)(y.value),k.value=801,!0}catch(e){return(0,s.A)(`二维码创建失败${e}`,{type:"error",timeout:2e3}),!1}})),_=setInterval((()=>d(this,void 0,void 0,(function*(){if(!v.value)return;const{state:e,cookie:a}=yield(0,o.PH)(y.value);switch(k.value=e,k.value){case 800:(0,s.A)("二维码失效,请刷新页面",{type:"error",timeout:2e3});break;case 803:(0,s.A)("登录成功",{type:"success",timeout:1500}),t.update_cookie(a);const{id:e,name:u}=yield(0,o.bG)();t.update_login(!0),t.update_id(e),t.update_name(u),l.Z.setItems({cookie:a,id:e.toString(),name:u}),n.push(n.currentRoute.value.query.redirect||"/");break;default:break}}))),2e3);return(e,t)=>{const n=a.F8;return(0,u.wg)(),(0,u.iD)("div",f,[p,(0,u._)("div",h,[(0,u.Wm)(n,{style:{width:"200px",height:"200px"},src:v.value,fit:"contain"},null,8,["src"])])])}}}),k=n(465);const m=(0,k.Z)(y,[["__scopeId","data-v-afe27772"]]);var _=m}}]);